<!DOCTYPE html>
<html>
<head><title>Local BroadcastChannel Chat</title></head>
<body>
<h2>Chat en la misma máquina (múltiples pestañas)</h2>
<ul id="messages"></ul>
<input id="msg" placeholder="Escribe algo"/>
<button onclick="send()">Enviar</button>

<script>
const channel = new BroadcastChannel('chat_channel');
const messages = document.getElementById('messages');

channel.onmessage = e => {
  const li = document.createElement('li');
  li.textContent = 'Peer: ' + e.data;
  messages.appendChild(li);
};

function send() {
  const input = document.getElementById('msg');
  if(input.value.trim() === '') return;
  channel.postMessage(input.value);
  const li = document.createElement('li');
  li.textContent = 'You: ' + input.value;
  messages.appendChild(li);
  input.value = '';
}
</script>
</body>
</html>
